{%- macro format_element(data, depth=1) -%}
  {# 动态计算标题级别 #}
  {%- set h_level = [depth, 6] | min -%}
  
  {%- if data is string -%}
    <p>{{ data | e }}</p>

  {%- elif data is mapping -%}
    {%- for key, value in data.items() -%}
      <h{{ h_level }}>{{ key | e }}</h{{ h_level }}>
      {{ format_element(value, depth + 1) }}
    {%- endfor -%}

  {%- elif data is sequence -%}
    <ul>
      {%- for item in data -%}
        <li>{{ format_element(item, depth + 1) }}</li>
      {%- endfor -%}
    </ul>
  
  {%- else -%}
    {# 处理数字/布尔值等基本类型 #}
    <p>{{ data }}</p>
  {%- endif -%}
{%- endmacro -%}

{%- macro format_content(data) -%}
{{ format_element(data) }}
{%- endmacro -%}